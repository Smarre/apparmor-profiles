# Profile for process info tool.

#include <tunables/global>

/bin/ps flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/consoles>
  #include <abstractions/nameservice>

  capability dac_read_search,
  capability sys_ptrace,

  ptrace read,

  /bin/ps mr,

  @{PROC}/ r,
  @{PROC}/@{uid}/attr/current r,
  @{PROC}/@{uid}/cmdline r,
  @{PROC}/@{uid}/environ r,
  @{PROC}/@{uid}/stat r,
  @{PROC}/@{uid}/status r,
  @{PROC}/sys/kernel/osrelease r,
  @{PROC}/sys/kernel/pid_max r,
  @{PROC}/tty/drivers r,
  @{PROC}/uptime r,

  @{PROC}/@{uid}/auxv r,
  @{PROC}/@{uid}/wchan r,
  @{PROC}/filesystems r,
  @{PROC}/meminfo r,
  @{PROC}/stat r,
  @{PROC}/sys/crypto/fips_enabled r,

  /sys/devices/system/cpu/online r,

}

# Profile for Firefox.

#include <tunables/global>

# Firefox seems to be launchable through different ways, so this profile tries to take care of them all.

# WARNING: this is old, non-upstream profile. Probably shouldnâ€™t be used.

profile firefox /usr/lib64/firefox/firefox{,.sh} flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/dbus-session-strict>
  #include <abstractions/enchant>
  #include <abstractions/gnome>
  #include <abstractions/nameservice>
  #include <abstractions/ubuntu-konsole>
  #include <abstractions/vulkan>

  capability sys_admin,
  capability sys_chroot,

  ptrace read peer=/usr/lib64/firefox/firefox//null-/usr/lib64/firefox/firefox,

  /** r,
  /**/ r,
  /proc/*/net/arp r,
  /proc/*/net/route r,
  /sys/devices/system/cpu/cpu*/cache/index*/size r,
  /sys/devices/system/cpu/cpufreq/policy*/cpuinfo_max_freq r,
  /usr/bin/keepassxc-proxy mrPx,
  /usr/bin/plasma-browser-integration-host mrPx,
  /usr/lib/mozilla/kmozillahelper mrPx,
  /usr/lib64/firefox/firefox mrix,
  /usr/lib64/libproxy-*/modules/network_networkmanager.so mr,
  /usr/share/mozilla/**/ r,
  /var/cache/fontconfig/ rw,

  owner @{HOME}/** rw,
  owner @{HOME}/.ICEauthority r,
  owner @{HOME}/.Xauthority r,
  owner @{HOME}/.cache/fontconfig/* rk,
  owner @{HOME}/.cache/gtk-3.0/compose/*.cache r,
  owner @{HOME}/.cache/mesa_shader_cache/index rw,
  owner @{HOME}/.cache/mozilla/firefox/** rwk,
  owner @{HOME}/.config/gtk-3.0/settings.ini r,
  owner @{HOME}/.config/ibus/bus/* r,
  owner @{HOME}/.config/mimeapps.list r,
  owner @{HOME}/.fonts.conf r,
  owner @{HOME}/.fonts/ r,
  owner @{HOME}/.local/share/applications/ r,
  owner @{HOME}/.local/share/applications/mimeinfo.cache r,
  owner @{HOME}/.local/share/icons/ r,
  owner @{HOME}/.local/share/icons/**/ r,
  owner @{HOME}/.local/share/mime/mime.cache r,
  owner @{HOME}/.mozilla/firefox/** rwk,

  owner /dev/shm/org.chromium.* rw,
  owner /dev/shm/org.mozilla.ipc.* rw,

  owner /proc/*/gid_map rw,
  owner /proc/*/maps r,
  owner /proc/*/mountinfo r,
  owner /proc/*/setgroups rw,
  owner /proc/*/stat r,
  owner /proc/*/task/*/stat r,
  owner /proc/*/uid_map rw,
  owner /run/user/*/dconf/user rw,

}

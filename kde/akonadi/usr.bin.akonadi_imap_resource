# Last Modified: Fri Jan 24 08:08:44 2020
#include <tunables/global>

/usr/bin/akonadi_imap_resource {
  #include <abstractions/akonadi_resource_base>
  #include <abstractions/audio>
  #include <abstractions/nameservice>
  #include <abstractions/openssl>
  #include <abstractions/smar_kde>

  signal receive set=kill peer=/usr/bin/akonadi_control,
  signal receive set=term peer=/usr/bin/akonadi_control,

  /proc/cpuinfo r,
  /usr/bin/akonadi_imap_resource mr,
  /usr/share/akonadi/plugins/serializer/ r,
  /usr/share/akonadi/plugins/serializer/* r,
  /usr/share/ssl/ r,
  /var/lib/sss/pubconf/* r,

  # TODO: this looks bad here.
  /{usr/,}lib{,32,64}/** mr,

  # TODO: too lenient
  owner @{HOME}/.config/* rwk,

  owner @{HOME}/.config/akonadi/* rwk,
  owner @{HOME}/.local/share/akonadi/file_db_data/** rw,
  owner /run/user/[0-9]*/kcrash_* w,

}
